/*
 * Jolt Framework âš¡
 * Copyright (c) 2022 Brandon Jordan
 * Last Modified: August 11, 2022 01:14:30
 */
"use strict";let App={data:[],errorNodes:[],functions:[],events:[],fors:[],loops:[],tags:[],nodes:[],evals:[],reactiveAttributes:[],attributes:[],replaces:[],modelTags:[],context:[],urlParams:[],ready:()=>null,start(){App.tags.forEach(function(b){let a=$all(b.name);a&&0!==a.length&&a.forEach(function(a){b.callback(a)})}),App.attributes.forEach(function(b){let a=$all("["+b.name+"]");a&&0!==a.length&&a.forEach(function(a){b.callback(a)})}),window.location.href.includes("?")&&window.location.href.split("?")[1].split("&").forEach(function(b){let a=b.split("=");App.urlParams[a[0]]=a[1]})},create:function(a){a.ready&&"function"==typeof a.ready&&(this.ready=a.ready),a.data&&"object"==typeof a.data&&(this.data=a.data),a.functions&&"object"==typeof a.functions&&(this.functions=a.functions)},error:function(b,a){a&&this.errorNodes.push(a),console.error(`[Framework] ${b}`,a,b.stack)},errorMsg:function(b,a){a&&this.errorNodes.push(a),console.trace(`[Framework] ${b}`,a)},replacers:function(){for(let c in this.replaces){let d=this.replaces[c].id;if(d&&$(`#${d}`)){let a=this.replaces[c].value,e=this.replaces[c].name,b=document.getElementById(d);for(let f in this.data)null!==this.data[f]&&(a=a.replaceAll("{"+f+"}",this.data[f]));b&&(b.getAttribute(e)&&b.getAttribute(e)===a||b.setAttribute(e,a))}}},buildContext:function(){let a=Object.keys(this.data);this.context=[],a.forEach(function(b){let a=App.data[b];if(Array.isArray(a)){let c=[];a.forEach(function(a){"string"==typeof a&&c.push(`"${a}"`)}),a="["+c.join(",")+"]"}else"object"==typeof a?a=JSON.stringify(a):"string"==typeof a&&(a=`"${a}"`);App.context.push(`let ${b} = ${a};`)})},loop:function(a){if(!this.errorNodes.includes(a))try{if(this.replacers(),this.loops.forEach(a=>a()),Object.keys(this.nodes).includes(a.nodeName)&&this.nodes[a.nodeName](a),a.attributes&&0!==a.attributes.length){this.buildContext();let e=getAttributes(a);for(let f in e.includes("model")&&e.includes("eval")&&this.errorMsg("Do not use model and eval attributes on the same element!",a),a.attributes){let b=a.attributes[f].nodeName;if(void 0===b)continue;let g=a.attributes[f].nodeValue,h=b.toLowerCase();if(Object.keys(this.reactiveAttributes).includes(h)&&this.reactiveAttributes[h](g,a),"."===b.split("")[0]){""===a.id&&(a.id=Random.id("id"));let i=Random.id("");App.replaces[i]={id:a.id,name:b.trimPrefix("."),value:g},a.removeAttribute(b)}}}}catch(j){this.error(j,a)}let d=a.childNodes;for(let c=0;c<d.length;c++)d[c]&&d[c].childNodes&&this.loop(d[c])},registerReactiveAttribute:function(a,b){a=a.toLowerCase(),this.reactiveAttributes.includes(a)||(this.reactiveAttributes[a]=b)},registerAttribute:function(a,b){a=a.toLowerCase(),this.attributes.includes(a)||(this.attributes[a]=b)},registerReactiveTag:function(a,b){a=a.toUpperCase(),this.nodes.includes(a)||(this.nodes[a]=b)},registerTag:function(a,b){this.tags.push({name:a,callback:b})},registerLoop:function(a){this.loops.push(a)},Data(a,b){if(a.constructor===Object)for(let c in a)App.data[c]=a[c];else if(!b)return!!Object.keys(App.data).includes(a)&&App.data[a];else if(void 0!==b)return App.data[a]=b},Get:a=>!!Object.keys(App.urlParams).includes(a)&&App.urlParams[a]},Random={id(b){let a=()=>((1+Math.random())*65536|0).toString(16).substring(1);return b+(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())},number:a=>Math.floor(Math.random()*a),color:()=>"#"+Math.floor(16777215*Math.random()).toString(16)};function $(selector){return document.querySelector(selector)}function $all(selector){return document.querySelectorAll(selector)}function escape(unsafe){return null===unsafe?unsafe:unsafe.replace(/[&<"']/g,function(a){switch(a){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";default:return"&#039;"}})}function getAttributes(element){let attrs=[];for(let attr in element.attributes){let attribute=element.attributes[attr].nodeName;void 0!==attribute&&attrs.push(attribute)}return attrs}let HTTP={request:(a,b,c)=>new HttpRequest(a,b,c),get:(a,b)=>new HttpRequest("GET",a,b).send(),post:(a,b)=>new HttpRequest("POST",a,b).send(),put:(a,b)=>new HttpRequest("PUT",a,b).send(),patch:(a,b)=>new HttpRequest("PATCH",a,b).send(),delete:(a,b)=>new HttpRequest("DELETE",a,b).send()};class HttpRequest{constructor(b,c,a){this.request=new XMLHttpRequest;let d="";if(this.method=b,void 0!==a){if(a.responseType&&(this.request.responseType=a.responseType),a.data){if("GET"===this.method)c+="?"+new URLSearchParams(a.data).toString();else{let e=new FormData;for(let f in a.data)e.append(f,a.data[f]);d=e}}if(a.headers)for(let g in a.headers)this.request.setRequestHeader(g,a.headers[g])}this.request.open(b,c,!0),this.request.send(d)}send(){return new Promise(a=>{this.request.onload=()=>{if(this.request.status>=200&&this.request.status<400)a({data:this.request.response,type:this.request.responseType,status:this.request.status,statusText:this.request.statusText});else throw this.error(),new Error(this.request.response)},this.request.onerror=()=>{throw this.error(),new Error(this.request.response)},this.request.ontimeout=()=>{throw this.error(),new Error("timeout")},this.request.onabort=()=>{throw this.error(),new Error("aborted")}})}error(){console.error(`HTTP.${this.method}(): ${this.request.status} `+(this.request.response?this.request.response:""))}progress(a){return this.request.onprogress=b=>{b.lengthComputable?a(b.loaded/b.total*100):a(0)},this}}function get(url){return new HttpRequest("GET",url).send()}window.onload=()=>{User.getAgent(),App.start(),App.ready(),setInterval(function(){App.loop(document)},100)},String.prototype.listAdd=function(c,d=","){let a=this.split(d);for(let b=0;b<a.length;b++)a[b]!==c&&a.push(c);return a.join(d)},String.prototype.listRemove=function(d,c=","){let a=this.split(c);for(let b=0;b<a.length;b++)a[b]===d&&a.splice(b,1);return a.join(c)},String.prototype.trimChar=function(a){return this.toString().replaceAll(a,"")},String.prototype.trimPrefix=function(e){let c=this.toString().split(""),b=e.split(""),d=!0;for(let a=0;a<b.length;a++)c[a]!==b[a]&&(d=!1);return d&&b.forEach(function(b,a){c.splice(a,1)}),c.join("")},String.prototype.trimSuffix=function(e){let c=this.toString().split("").reverse(),b=e.split("").reverse(),d=!0;for(let a=0;a<b.length;a++)c[a]!==b[a]&&(d=!1);return d&&b.forEach(function(b,a){c.splice(a,1)}),c.reverse().join("")},String.prototype.stripTags=function(){return this.toString().replace(/<\/?[^>]+(>|$)/gi,"")},Array.prototype.end=()=>this[this.length-1],Array.prototype.pluck=function(b){let a=[];return 0!==this.length&&this.forEach(function(c){b in c&&a.push(c[b])}),a},Array.prototype.remove=function(b){let a=this.indexOf(b);a> -1&&this.splice(a,1)},Array.prototype.removeAll=function(b){let a=0;for(;a<this.length;)this[a]===b?this.splice(a,1):++a};let User={language:navigator.language,browser:{name:"",version:"",fullVersion:"",headless:!1,webview:!1,bot:!1},engine:{name:"",version:"",fullVersion:""},platform:{name:"",mobile:!1,version:""},getAgent:function(){let b=navigator.userAgent;if(User.browser.headless=b.includes("Headless"),["addthis.com","Mediapartners-Google","newspaper/0.2.8","zgrab","ggpht.com","naver.me","admantx.com","BingPreview","facebookexternalhit","Daum/"].forEach(function(a){User.browser.bot=b.includes(a)}),User.browser.bot=b.includes("bot")||b.includes("spider"),navigator.userAgentData){let a=navigator.userAgentData;a.brands[1]&&(this.browser.name=a.brands[1].brand,this.browser.version=a.brands[1].version),a.brands[2]&&(this.engine.name=a.brands[2].brand,this.engine.version=a.brands[2].version),this.platform.name=a.platform.toLowerCase(),this.platform.mobile=a.mobile,"Google Chrome"===this.browser.name&&(this.browser.name="chrome"),"Chromium"===this.engine.name&&(this.engine.name="blink")}else this.oldUserAgent()},oldUserAgent:function(){let a=navigator.userAgent;if(a.includes("Edge/")||a.includes("Edg/"))User.browser.name="edge";else if(a.includes("OPR/"))User.browser.name="opera";else if(a.includes("Chrome/"))User.browser.name="chrome";else if(a.includes("Macintosh;")&&a.includes("AppleWebKit/")){let e=this.parseVersion("Version");User.browser.name="safari",User.browser.version=e.version,User.browser.fullVersion=e.fullVersion}else if(a.includes("Safari/")&&a.includes("AppleWebKit/")){let f=this.parseVersion("Version");User.browser.name="safari",User.browser.version=f.version,User.browser.fullVersion=f.fullVersion}else if(a.includes("iPhone OS")){let g=this.parseVersion("AppleWebKit");User.browser.name="safari",User.browser.version=g.version,User.browser.fullVersion=g.fullVersion}else if(a.includes("Waterfox/")){let h=this.parseVersion("Waterfox");User.browser.name="waterfox",User.browser.version=h.version,User.browser.fullVersion=h.fullVersion}else if(a.includes("Firefox/")){let i=this.parseVersion("Firefox");User.browser.name="firefox",User.browser.version=i.version,User.browser.fullVersion=i.fullVersion}else a.includes("Trident/")&&a.includes("MSIE")&&(User.browser.name="ie");if(a.includes("Edge")){let b=this.parseVersion("Edge");User.engine.name="edgeHTML",User.browser.version=b.version,User.browser.fullVersion=b.fullVersion,User.engine.version=b.version,User.engine.fullVersion=b.fullVersion}else if(a.includes("Edg")){let c=this.parseVersion("Edg");User.engine.name="blink",User.browser.version=c.version,User.browser.fullVersion=c.fullVersion,User.engine.version=c.version,User.engine.fullVersion=c.fullVersion}else if(a.includes("Chrome")){let d=this.parseVersion("Chrome");User.engine.name="blink",User.browser.version=d.version,User.browser.fullVersion=d.fullVersion,User.engine.version=d.version,User.engine.fullVersion=d.fullVersion}else if(a.includes("AppleWebKit")&&a.includes("Macintosh")||a.includes("iPhone OS")){let j=this.parseVersion("AppleWebKit");User.engine.name="webkit",User.engine.version=j.version,User.engine.fullVersion=j.fullVersion}else if(a.includes("Gecko")){let k=this.parseVersion("Gecko");User.engine.name="gecko",User.engine.version=k.fullVersion,User.engine.fullVersion=k.fullVersion}else if(a.includes("Trident")){let l=this.parseVersion("Trident");User.engine.name="trident",User.engine.version=l.fullVersion,User.engine.fullVersion=l.fullVersion}a.includes("Windows NT")?(User.platform.name="windows",User.platform.mobile=!1):a.includes("Macintosh")?(User.platform.name="macos",User.platform.mobile=!1):a.includes("iPhone OS")?(User.platform.name="ios",User.platform.mobile=!0,User.browser.webview=a.includes("WKWebView")):a.includes("Android")?(User.platform.name="android",User.platform.mobile=!0,User.browser.webview=a.includes("; wv")):a.includes("Linux")&&(User.platform.name="linux",User.platform.mobile=!1),!1===User.platform.mobile&&a.includes("Mobile")&&(User.platform.mobile=!0),a.includes("Android")?User.platform.version=a.split(" Android ")[1].split(";")[0].trim():a.includes("iPhone OS")?User.platform.version=a.split(" iPhone OS ")[1].split("like")[0].replaceAll("_",".").trim():a.includes("Mac OS X")?User.platform.version=a.split(" X ")[1].split(")")[0].replaceAll("_",".").trim():a.includes("Windows NT")&&(User.platform.version=a.split("Windows NT ")[1].split(";")[0].trim())},parseVersion(b){let a=navigator.userAgent.split(b+"/")[1].split(" ")[0];return{version:a.split(".")[0],fullVersion:a}}};function makeEvent(type,value,node){if(!App.events.includes(node)){let functionName=value.split("(")[0];if(value.includes("(")||value.includes(")")||(value+="()"),eval(`typeof App.functions.${functionName} === 'function'`)){switch(type){case"click":node.onclick=()=>{eval(App.context.join("\n")+`App.functions.${value}`)};break;case"change":node.onchange=()=>{eval(App.context.join("\n")+`App.functions.${value}`)}}App.events.push(node)}else App.errorMsg(`[click] Function ${value} is not a registered function.`,node)}}function makeShortcut(shortcut,platform){void 0===platform&&(platform=User.platform.name);let platformSymbols={macos:{cmd:"&#8984;",opt:"&#8997;",delete:"&#9003;",esc:"&#9099;",return:"&#9166;"},windows:{enter:"&#9166;"}},symbols={ctrl:"&#8963;",shift:"&#8679;",up:"&uarr;",left:"&larr;",right:"&rarr;",down:"&darr;"},keys=[];return shortcut.replace(" ","").trim().split("+").forEach(function(a){"super"===(a=a.trim().stripTags())?"windows"===platform?a="ctrl":"macos"===platform&&(a="cmd"):"control"===a?a="ctrl":"command"===a?a="cmd":"option"===a?a="opt":"escape"===a?a="esc":"alt"===a&&"macos"===platform?a="opt":("enter"===a||"return"===a)&&("windows"===platform?a="enter":"macos"===platform&&(a="return"));let b=platformSymbols[platform][a];b&&(a=`${b} ${a}`);let c=symbols[a];c&&(a=`${c} ${a}`),keys.push(a)}),"<kbd>"+keys.join("</kbd> + <kbd>")+"</kbd>"}App.registerReactiveAttribute("click",function(a,b){makeEvent("click",a,b)}),App.registerReactiveAttribute("change",function(a,b){makeEvent("change",a,b)}),App.registerReactiveAttribute("foreach",function(f,a){let b=a;""===a.parentNode.id&&(a.parentNode.id=Random.id("id"));let d=a.parentNode.id;a.parentNode.innerHTML="",a.remove();let c=b.attributes.foreach.nodeValue.split(" in ");b.removeAttribute("foreach");let e={node:b.outerHTML,replace:"{"+c[0]+"}",parent:d,property:c[1],items:[]};App.fors.push(e)}),App.registerLoop(function(){App.fors.forEach(function(a){if(App.Data(a.property)&&Array.isArray(App.data[a.property])){let b="",c=$("#"+a.parent);App.data[a.property].forEach(function(c){b+=a.node.replaceAll(a.replace,c)}),c.innerHTML!==b&&(c.innerHTML=b)}})}),App.registerReactiveAttribute("html",function(b,a){if(App.Data(b)){let c=["INPUT","TEXTAREA","SELECT","BUTTON"];c.includes(a.nodeName)?App.errorMsg("[html] Data property '"+b+"' cannot be modeled as HTML because the element is a <"+a.nodeName+"> tag.",a):a.innerHTML!==App.data[b]&&(a.innerHTML=App.data[b])}else App.errorMsg("[html] Data property '"+b+"' does not exist.",a)}),App.registerReactiveAttribute("model",function(c,a){if(Object.keys(App.data).includes(c)){if("INPUT"===a.nodeName||"TEXTAREA"===a.nodeName||"SELECT"===a.nodeName)""===a.id&&(a.id=Random.id("id")),"checkbox"!==a.type&&"boolean"==typeof App.data[c]&&App.errorMsg("Only checkbox and radio inputs can model booleans",a),App.events.includes(a.id)||("checkbox"===a.type?"boolean"==typeof App.data[c]?a.onchange=()=>{App.data[c]=a.checked}:App.errorMsg("Checkbox inputs can only model booleans",a):"range"===a.type||"SELECT"===a.nodeName?a.onchange=()=>{let b=a.value;"number"==typeof App.data[c]&&(b=b?parseInt(b):0),App.data[c]=b}:a.onkeyup=()=>{let b=a.value;"number"==typeof App.data[c]&&(b=b?parseInt(b):0),App.data[c]=b},App.events.push(a.id)),a!==document.activeElement&&("checkbox"===a.type?a.checked!==App.data[c]&&(a.checked=App.data[c]):("text"===a.type||"range"===a.type||"TEXTAREA"===a.nodeName||"SELECT"===a.nodeName)&&a.value!==App.data[c]&&(a.value=App.data[c]));else{let b=App.data[c];if(null===b);else if(Array.isArray(b)){if("UL"===a.nodeName||"OL"===a.nodeName){let h="<li>"+b.join("</li><li>")+"</li>";a.innerHTML!==h&&(a.innerHTML="",b.forEach(function(c){let b=document.createElement("li");b.innerText=c,a.appendChild(b)}))}else if("TABLE"===a.nodeName){let d="",i=!1;b.forEach(function(a){a.constructor===Object&&(i=!0)}),i&&(d="<thead><tr>",Object.keys(b[0]).forEach(function(a){d+="<th>"+a.stripTags()+"</th>"}),d+="</tr></thead><tbody>",b.forEach(function(a){d+="<tr>",a.constructor===Object&&Object.values(a).forEach(function(a){d+="<td>"+a.toString().stripTags()+"</td>"}),d+="</tr>"}),d+="</tbody>"),a.innerHTML!==d&&(a.innerHTML=d)}}else if(b.constructor===Object){if("TABLE"===a.nodeName){let e="<tbody>";for(let f in b){let g=b[f];Array.isArray(b[f])&&(g=b[f].join(", ")),e+=`<tr><td>${f.stripTags()}</td><td>`+g.toString().stripTags()+"</td></tr>"}e+="</tbody>",a.innerHTML!==e&&(a.innerHTML=e)}}else a.innerText!==b.toString()&&(a.innerText=b)}}else App.errorMsg("[model] Data property '"+c+"' does not exist.",a)}),App.registerAttribute("prevent",function(b,a){"submit"===a.attributes.prevent.value&&(a.onsubmit=function(){return!1})}),App.registerReactiveAttribute("toggle",function(a,b){App.events.includes(a)||($(a)?(b.onclick=()=>{let b=$(a);null!==b&&(b.style.display="none"===b.style.display?"block":"none")},App.events.push(a)):App.errorMsg(`[toggle] Element ${a} does not exist.`,b))}),App.registerReactiveAttribute("if",function(value,node){!0===eval(App.context.join("\n")+value)?node.style.display="block":node.style.display="none"}),App.registerReactiveAttribute("eval",function(value,node){let result=eval(App.context.join("\n")+value).toString();result!==node.innerText&&(node.innerText=result)}),App.registerReactiveTag("eval",function(a){""===a.id&&(a.id=Random.id("id")),Object.keys(App.evals).includes(a.id)||(App.evals[a.id]=a.innerText)}),App.registerLoop(function(){for(let e in App.evals){let element=document.getElementById(e);if(element){let result=eval(App.context.join("\n")+App.evals[e]).toString();result!==element.innerText&&(element.innerText=result)}}}),App.registerReactiveTag("model",function(a){""===a.id&&(a.id=Random.id("id")),!Object.keys(App.modelTags).includes(a.id)&&a.innerText&&(Object.keys(App.data).includes(a.innerText)?App.modelTags[a.id]=a.innerText:(a.innerText="",App.errorMsg(" <model> Data property '"+a.innerText+"' does not exist.",a)))}),App.registerLoop(function(){for(let c in App.modelTags){let a=App.modelTags[c],d=$("#"+c);if(Object.keys(App.data).includes(a)&&d){let b=d;if(null!==App.data[a]){let e=App.data[a].toString().stripTags();b.innerText!==e&&(b.innerText=e)}else b.innerText=""}}}),App.registerTag("shortcut",a=>{a.innerText&&("windows"!==User.platform.name&&"macos"!==User.platform.name?a.innerHTML=makeShortcut(a.innerText,"windows")+" on Windows or "+makeShortcut(a.innerText,"macos")+" on macOS":a.innerHTML=makeShortcut(a.innerText))})